{"version":3,"file":"module.js","sources":["../../src/scripts/constants/constants.mjs","../../src/scripts/systems/dnd5e.mjs","../../src/scripts/systems/pf2e.mjs","../../src/scripts/systems/swade.mjs","../../src/scripts/systems/sw5e.mjs","../../src/scripts/systems/wfrp4e.mjs","../../src/scripts/systems/generic.mjs","../../src/scripts/systems.mjs","../../src/scripts/lib/lib.mjs","../../src/scripts/apps/ItemProperties.mjs","../../src/scripts/settings.mjs","../../src/scripts/constants/settings.mjs","../../src/scripts/apps/DefaultIcons.mjs","../../src/scripts/ForienUnidentifiedItemsModels.mjs","../../src/scripts/ForienUnidentifiedItemsIdentification.mjs","../../src/scripts/api.mjs","../../src/scripts/ForienUnidentifiedItemsItemSheet.mjs","../../src/scripts/ContextMenu.mjs","../../src/scripts/ForienUnidentifiedItemsItem.mjs","../../src/module.js"],"sourcesContent":["const CONSTANTS = {\n  MODULE_NAME: \"forien-unidentified-items\",\n  PATH: `modules/forien-unidentified-items/`,\n  DEFAULT_ICON: \"unidentified.png\",\n};\n\nCONSTANTS.PATH = `modules/${CONSTANTS.MODULE_NAME}/`;\n\nexport default CONSTANTS;\n","import CONSTANTS from \"../constants/constants.mjs\";\n\nexport default {\n  DEFAULT_PROPERTIES: {\n    weapon: {\n      weight: true,\n      quantity: true,\n      weaponType: true,\n      equipped: true,\n    },\n    equipment: {\n      weight: true,\n      quantity: true,\n      \"armor.type\": true,\n      equipped: true,\n    },\n    consumable: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n      consumableType: true,\n    },\n    tool: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n    },\n    loot: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n    },\n    backpack: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n    },\n  },\n  DEFAULT_ICONS: {\n    weapon: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified.png`,\n    equipment: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-armor.png`,\n    consumable: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-potion.png`,\n    tool: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-tool.png`,\n    loot: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-loot.png`,\n    background: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    class: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    subclass: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    spell: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-scroll.png`,\n    feat: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    backpack: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-knapsack.png`,\n  },\n};\n","import CONSTANTS from \"../constants/constants.mjs\";\n\nexport default {\n  DEFAULT_PROPERTIES: {\n    weapon: {\n      \"bulkCapacity.value\": true,\n      \"quantity.value\": true,\n      \"weaponType.value\": true,\n    },\n    melee: {\n      \"bulkCapacity.value\": true,\n      \"quantity.value\": true,\n    },\n    armor: {\n      \"armorType.value\": true,\n      \"bulkCapacity.value\": true,\n      \"quantity.value\": true,\n    },\n    equipment: {\n      \"bulkCapacity.value\": true,\n      \"quantity.value\": true,\n    },\n    consumable: {\n      \"bulkCapacity.value\": true,\n      \"consumableType.value\": true,\n      \"quantity.value\": true,\n      \"uses.value\": true,\n    },\n    treasure: {\n      \"bulkCapacity.value\": true,\n      \"quantity.value\": true,\n    },\n  },\n  DEFAULT_ICONS: {\n    weapon: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified.png`,\n    equipment: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-armor.png`,\n    consumable: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-potion.png`,\n    tool: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-tool.png`,\n    loot: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-loot.png`,\n    background: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    class: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    subclass: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    spell: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-scroll.png`,\n    feat: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    backpack: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-knapsack.png`,\n  },\n};\n","import CONSTANTS from \"../constants/constants.mjs\";\n\nexport default {\n  DEFAULT_PROPERTIES: {\n    weapon: {\n      quantity: true,\n      weight: true,\n      equippable: true,\n      equipped: true,\n      minStr: true,\n    },\n    armor: {\n      quantity: true,\n      weight: true,\n      equippable: true,\n      equipped: true,\n      minStr: true,\n      \"locations.head\": true,\n      \"locations.torso\": true,\n      \"locations.arms\": true,\n      \"locations.legs\": true,\n    },\n    shield: {\n      quantity: true,\n      weight: true,\n      equippable: true,\n      equipped: true,\n      minStr: true,\n      cover: true,\n    },\n    gear: {\n      quantity: true,\n      weight: true,\n      equippable: true,\n      equipped: true,\n    },\n  },\n  DEFAULT_ICONS: {\n    weapon: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified.png`,\n    equipment: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-armor.png`,\n    consumable: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-potion.png`,\n    tool: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-tool.png`,\n    loot: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-loot.png`,\n    background: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    class: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    subclass: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    spell: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-scroll.png`,\n    feat: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    backpack: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-knapsack.png`,\n  },\n};\n","import CONSTANTS from \"../constants/constants.mjs\";\n\nexport default {\n  DEFAULT_PROPERTIES: {\n    weapon: {\n      weight: true,\n      quantity: true,\n      weaponType: true,\n      equipped: true,\n    },\n    equipment: {\n      weight: true,\n      quantity: true,\n      \"armor.type\": true,\n      equipped: true,\n    },\n    consumable: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n      consumableType: true,\n    },\n    tool: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n    },\n    loot: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n    },\n    backpack: {\n      weight: true,\n      quantity: true,\n      equipped: true,\n    },\n  },\n  DEFAULT_ICONS: {\n    weapon: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified.png`,\n    equipment: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-armor.png`,\n    consumable: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-potion.png`,\n    tool: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-tool.png`,\n    loot: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-loot.png`,\n    background: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    class: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    subclass: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    spell: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-scroll.png`,\n    feat: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    backpack: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-knapsack.png`,\n  },\n};\n","import CONSTANTS from \"../constants/constants.mjs\";\n\nexport default {\n  DEFAULT_PROPERTIES: {\n    ammunition: {\n      \"encumbrance.value\": true,\n      \"quantity.value\": true,\n      \"gmdescription.value\": true,\n      \"ammunitionType.value\": true,\n    },\n    armour: {\n      \"encumbrance.value\": true,\n      \"quantity.value\": true,\n      \"gmdescription.value\": true,\n      \"location.value\": true,\n      \"armorType.value\": true,\n    },\n    container: {\n      \"encumbrance.value\": true,\n      \"quantity.value\": true,\n      \"gmdescription.value\": true,\n    },\n    money: {\n      \"encumbrance.value\": true,\n      \"quantity.value\": true,\n      \"gmdescription.value\": true,\n    },\n    trapping: {\n      \"encumbrance.value\": true,\n      \"quantity.value\": true,\n      \"gmdescription.value\": true,\n      \"trappingType.value\": true,\n    },\n    weapon: {\n      \"encumbrance.value\": true,\n      \"quantity.value\": true,\n      \"gmdescription.value\": true,\n      \"twohanded.value\": true,\n      \"ammunitionGroup.value\": true,\n      \"weaponGroup.value\": true,\n      \"reach.value\": true,\n    },\n    DEFAULT_ICONS: {\n      weapon: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified.png`,\n      equipment: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-armor.png`,\n      consumable: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-potion.png`,\n      tool: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-tool.png`,\n      loot: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-loot.png`,\n      background: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n      class: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n      subclass: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n      spell: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-scroll.png`,\n      feat: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n      backpack: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-knapsack.png`,\n    },\n  },\n};\n","import CONSTANTS from \"../constants/constants.mjs\";\n\nexport default {\n  DEFAULT_PROPERTIES: {},\n  DEFAULT_ICONS: {\n    weapon: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified.png`,\n    equipment: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-armor.png`,\n    consumable: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-potion.png`,\n    tool: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-tool.png`,\n    loot: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-loot.png`,\n    background: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    class: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    subclass: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified.png`,\n    spell: `/modules/${CONSTANTS.MODULE_NAME}/icons/inv-unidentified-scroll.png`,\n    feat: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-book.png`,\n    backpack: `/modules/${CONSTANTS.MODULE_NAME}/icons/unidentified-knapsack.png`,\n  },\n};\n","// ↓ IMPORT SYSTEMS HERE ↓\nimport dnd5e from \"./systems/dnd5e.mjs\";\nimport pf2e from \"./systems/pf2e.mjs\";\nimport swade from \"./systems/swade.mjs\";\nimport sw5e from \"./systems/sw5e.mjs\";\nimport wfrp4e from \"./systems/wfrp4e.mjs\";\nimport generic from \"./systems/generic.mjs\";\n// ↑ IMPORT SYSTEMS HERE ↑\n\n/**\n * NOTE: YOUR PULL REQUEST WILL NOT BE ACCEPTED IF YOU DO NOT\n * FOLLOW THE CONVENTION IN THE D&D 5E SYSTEM FILE\n */\nexport const SYSTEMS = {\n  SUPPORTED_SYSTEMS: {\n    // ↓ ADD SYSTEMS HERE ↓\n    alienrpg: {\n      latest: generic,\n    },\n    dnd4e: {\n      latest: generic,\n    },\n    dnd5e: {\n      latest: dnd5e,\n    },\n    pf1: {\n      latest: generic,\n    },\n    pf2e: {\n      latest: pf2e,\n    },\n    ds4: {\n      latest: generic,\n    },\n    d35e: {\n      latest: generic,\n    },\n    \"blade-runner\": {\n      latest: generic,\n    },\n    sfrpg: {\n      latest: generic,\n    },\n    swade: {\n      latest: swade,\n    },\n    tormenta20: {\n      latest: generic,\n    },\n    wfrp4e: {\n      latest: wfrp4e,\n    },\n    splittermond: {\n      latest: generic,\n    },\n    \"forbidden-lands\": {\n      latest: generic,\n    },\n    icrpg: {\n      latest: generic,\n    },\n    icrpgme: {\n      latest: generic,\n    },\n    swse: {\n      latest: generic,\n    },\n    sw5e: {\n      latest: sw5e,\n    },\n    fallout: {\n      latest: generic,\n    },\n    \"cyberpunk-red-core\": {\n      latest: generic,\n    },\n    knave: {\n      latest: generic,\n    },\n    t2k4e: {\n      latest: generic,\n    },\n    yzecoriolis: {\n      latest: generic,\n    },\n    kamigakari: {\n      latest: generic,\n    },\n    wwn: {\n      latest: generic,\n    },\n    symbaroum: {\n      latest: generic,\n    },\n    cyphersystem: {\n      latest: generic,\n    },\n    ptu: {\n      latest: generic,\n    },\n    dcc: {\n      latest: generic,\n    },\n    a5e: {\n      latest: generic,\n    },\n    \"dark-heresy\": {\n      latest: generic,\n    },\n    naheulbeuk: {\n      latest: generic,\n    },\n    // ↑ ADD SYSTEMS HERE ↑\n  },\n\n  DEFAULT_SETTINGS: {\n    DEFAULT_ICONS: {},\n    DEFAULT_PROPERTIES: {},\n  },\n\n  get HAS_SYSTEM_SUPPORT() {\n    return !!this.SUPPORTED_SYSTEMS?.[game.system.id.toLowerCase()];\n  },\n\n  _currentSystem: false,\n\n  get DATA() {\n    if (this._currentSystem) return this._currentSystem;\n\n    const system = this.SUPPORTED_SYSTEMS?.[game.system.id.toLowerCase()];\n    if (!system) return this.DEFAULT_SETTINGS;\n\n    if (system[game.system.version]) {\n      this._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[game.system.version]);\n      return this._currentSystem;\n    }\n\n    const versions = Object.keys(system);\n    if (versions.length === 1) {\n      this._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[versions[0]]);\n      return this._currentSystem;\n    }\n\n    versions.sort((a, b) => {\n      return a === \"latest\" || b === \"latest\" ? -Infinity : isNewerVersion(b, a) ? -1 : 1;\n    });\n    const version = versions.find((version) => {\n      return version === \"latest\" || !isNewerVersion(game.system.version, version);\n    });\n\n    this._currentSystem = foundry.utils.mergeObject(this.DEFAULT_SETTINGS, system[version]);\n\n    return this._currentSystem;\n  },\n\n  addSystem(data) {\n    this.SUPPORTED_SYSTEMS[game.system.id.toLowerCase()] = { latest: data };\n  },\n};\n","import CONSTANTS from \"../constants/constants.mjs\";\n\n// =============================\n// Module Generic function\n// =============================\n\nexport function isGMConnected() {\n  return Array.from(game.users).find((user) => user.isGM && user.active) ? true : false;\n}\n\nexport function wait(ms) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n\n// export let debugEnabled = 0;\n// 0 = none, warnings = 1, debug = 2, all = 3\n\nexport function debug(msg, args = \"\") {\n  if (game.settings.get(CONSTANTS.MODULE_NAME, \"debug\")) {\n    console.log(`DEBUG | ${CONSTANTS.MODULE_NAME} | ${msg}`, args);\n  }\n  return msg;\n}\n\nexport function log(message) {\n  message = `${CONSTANTS.MODULE_NAME} | ${message}`;\n  console.log(message.replace(\"<br>\", \"\\n\"));\n  return message;\n}\n\nexport function notify(message) {\n  message = `${CONSTANTS.MODULE_NAME} | ${message}`;\n  ui.notifications?.notify(message);\n  console.log(message.replace(\"<br>\", \"\\n\"));\n  return message;\n}\n\nexport function info(info, notify = false, permanent = false) {\n  info = `${CONSTANTS.MODULE_NAME} | ${info}`;\n  if (notify) ui.notifications?.info(info, { permanent: permanent });\n  console.log(info.replace(\"<br>\", \"\\n\"));\n  return info;\n}\n\nexport function warn(warning, notify = false) {\n  warning = `${CONSTANTS.MODULE_NAME} | ${warning}`;\n  if (notify) ui.notifications?.warn(warning);\n  console.warn(warning.replace(\"<br>\", \"\\n\"));\n  return warning;\n}\n\nexport function error(error, notify = true) {\n  error = `${CONSTANTS.MODULE_NAME} | ${error}`;\n  if (notify) ui.notifications?.error(error);\n  return new Error(error.replace(\"<br>\", \"\\n\"));\n}\n\nexport function timelog(message) {\n  warn(Date.now(), message);\n}\n\nexport const i18n = (key) => {\n  return game.i18n.localize(key)?.trim();\n};\n\nexport const i18nFormat = (key, data = {}) => {\n  return game.i18n.format(key, data)?.trim();\n};\n\n// export const setDebugLevel = (debugText) => {\n//   debugEnabled = { none: 0, warn: 1, debug: 2, all: 3 }[debugText] || 0;\n//   // 0 = none, warnings = 1, debug = 2, all = 3\n//   if (debugEnabled >= 3) CONFIG.debug.hooks = true;\n// };\n\nexport function dialogWarning(message, icon = \"fas fa-exclamation-triangle\") {\n  return `<p class=\"${CONSTANTS.MODULE_NAME}-dialog\">\n        <i style=\"font-size:3rem;\" class=\"${icon}\"></i><br><br>\n        <strong style=\"font-size:1.2rem;\">${CONSTANTS.MODULE_NAME}</strong>\n        <br><br>${message}\n    </p>`;\n}\n\n// =========================================================================================\n\n/**\n *\n * @param obj Little helper for loop enum element on typescript\n * @href https://www.petermorlion.com/iterating-a-typescript-enum/\n * @returns\n */\nexport function enumKeys(obj) {\n  return Object.keys(obj).filter((k) => Number.isNaN(+k));\n}\n\n/**\n * @href https://stackoverflow.com/questions/7146217/merge-2-arrays-of-objects\n * @param target\n * @param source\n * @param prop\n */\nexport function mergeByProperty(target, source, prop) {\n  source.forEach((sourceElement) => {\n    const targetElement = target.find((targetElement) => {\n      return sourceElement[prop] === targetElement[prop];\n    });\n    targetElement ? Object.assign(targetElement, sourceElement) : target.push(sourceElement);\n  });\n  return target;\n}\n\n/**\n * Returns the first selected token\n */\nexport function getFirstPlayerTokenSelected() {\n  // Get first token ownted by the player\n  const selectedTokens = canvas.tokens?.controlled;\n  if (selectedTokens.length > 1) {\n    //iteractionFailNotification(i18n(\"foundryvtt-arms-reach.warningNoSelectMoreThanOneToken\"));\n    return null;\n  }\n  if (!selectedTokens || selectedTokens.length === 0) {\n    //if(game.user.character.token){\n    //  //@ts-ignore\n    //  return game.user.character.token;\n    //}else{\n    return null;\n    //}\n  }\n  return selectedTokens[0];\n}\n\n/**\n * Returns a list of selected (or owned, if no token is selected)\n * note: ex getSelectedOrOwnedToken\n */\nexport function getFirstPlayerToken() {\n  // Get controlled token\n  let token;\n  const controlled = canvas.tokens?.controlled;\n  // Do nothing if multiple tokens are selected\n  if (controlled.length && controlled.length > 1) {\n    //iteractionFailNotification(i18n(\"foundryvtt-arms-reach.warningNoSelectMoreThanOneToken\"));\n    return null;\n  }\n  // If exactly one token is selected, take that\n  token = controlled[0];\n  if (!token) {\n    if (!controlled.length || controlled.length === 0) {\n      // If no token is selected use the token of the users character\n      token = canvas.tokens?.placeables.find((token) => token.actor?.id === game.user?.character?.id);\n    }\n    // If no token is selected use the first owned token of the users character you found\n    if (!token) {\n      token = canvas.tokens?.ownedTokens[0];\n    }\n  }\n  return token;\n}\n\nfunction getElevationToken(token) {\n  const base = token.document;\n  return getElevationPlaceableObject(base);\n}\n\nfunction getElevationWall(wall) {\n  const base = wall.document;\n  return getElevationPlaceableObject(base);\n}\n\nfunction getElevationPlaceableObject(placeableObject) {\n  let base = placeableObject;\n  if (base.document) {\n    base = base.document;\n  }\n  const base_elevation =\n    //@ts-ignore\n    typeof _levels !== \"undefined\" &&\n    //@ts-ignore\n    _levels?.advancedLOS &&\n    (placeableObject instanceof Token || placeableObject instanceof TokenDocument)\n      ? //@ts-ignore\n        _levels.getTokenLOSheight(placeableObject)\n      : base.elevation ??\n        base.flags[\"levels\"]?.elevation ??\n        base.flags[\"levels\"]?.rangeBottom ??\n        base.flags[\"wallHeight\"]?.wallHeightBottom ??\n        0;\n  return base_elevation;\n}\n\n// =============================\n// Module specific function\n// =============================\n","import CONSTANTS from \"../constants/constants.mjs\";\nimport SETTINGS from \"../constants/settings.mjs\";\nimport { i18n } from \"../lib/lib.mjs\";\nexport default class ItemProperties extends FormApplication {\n  static get defaultOptions() {\n    const options = mergeObject(super.defaultOptions, {\n      id: \"forien-unidentified-items-item-properties\",\n      template: `/scripts/${CONSTANTS.MODULE_NAME}/templates/settings-item-properties.html`,\n      title: i18n(`${CONSTANTS.MODULE_NAME}.Settings.itemProperties.name`),\n      submitOnClose: true,\n      submitOnChange: false,\n      closeOnSubmit: true,\n      resizable: true,\n      width: 640,\n      height: 560,\n      tabs: [{ navSelector: \".nav-tabs\", contentSelector: \".nav-body\" }],\n    });\n\n    if (game.system.id === \"wfrp4e\") {\n      options.classes.push(\"wfrp4e\");\n    }\n    return options;\n  }\n\n  getData(options = {}) {\n    const data = super.getData();\n    (data.types = this.getItemTypes()), (data.propertySettings = this.getSettings()), (data.options = this.options);\n    return data;\n    // return {\n    //   types: this.getItemTypes(),\n    //   propertySettings: this.getSettings(),\n    //   options: this.options\n    // };\n  }\n\n  activateListeners(html) {\n    super.activateListeners(html);\n  }\n\n  async _updateObject(event, formData) {\n    const data = Object.entries(formData);\n    const settings = {};\n\n    data.sort().map((d) => {\n      const type = d[0].split(\".\", 1)[0];\n      const property = d[0].replace(`${type}.`, \"\");\n      const value = d[1];\n\n      if (settings[type] === undefined) {\n        settings[type] = {};\n      }\n      settings[type][property] = value;\n    });\n\n    return await this.saveSettings(settings);\n  }\n\n  getProperties() {\n    const types = Object.entries(game.system.model.Item);\n    const properties = new Map(types);\n    for (const [key, value] of properties) {\n      properties.set(key, Object.keys(flattenObject(value)));\n    }\n    return properties;\n  }\n\n  getSettings() {\n    const settings = this.loadSettings();\n    const types = this.getItemTypes();\n    const properties = this.getProperties();\n\n    for (const type of types) {\n      const setting = getProperty(settings, type);\n      if (!setting) {\n        const typeProperties = properties.get(type);\n        settings[type] = typeProperties.reduce((a, b) => ((a[b] = false), a), {});\n      }\n    }\n\n    return settings;\n  }\n\n  loadSettings() {\n    return game.settings.get(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_PROPERTIES);\n  }\n\n  async saveSettings(data) {\n    if (data?.object) {\n      return await game.settings.set(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_PROPERTIES, data.object);\n    } else {\n      return await game.settings.set(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_PROPERTIES, data);\n    }\n  }\n\n  getItemTypes() {\n    return Object.keys(game.system.model.Item);\n  }\n\n  getIcon(icon) {\n    return `/scripts/${CONSTANTS.MODULE_NAME}/icons/${icon}`;\n  }\n}\n","import API from \"./api.mjs\";\nimport DefaultIcons from \"./apps/DefaultIcons.mjs\";\nimport ItemProperties from \"./apps/ItemProperties.mjs\";\nimport CONSTANTS from \"./constants/constants.mjs\";\nimport SETTINGS from \"./constants/settings.mjs\";\nimport { debug, dialogWarning, i18n, info, log, warn } from \"./lib/lib.mjs\";\nimport { SYSTEMS } from \"./systems.mjs\";\n\n/**\n * @param key\n * @returns {*}\n */\nexport function getSetting(key) {\n  return game.settings.get(CONSTANTS.MODULE_NAME, key);\n}\n\nexport function setSetting(key, value) {\n  if (value === undefined) {\n    throw new Error(\"setSetting | value must not be undefined!\");\n  }\n  return game.settings.set(CONSTANTS.MODULE_NAME, key, value);\n}\n\nexport default function registerSettings() {\n  game.settings.registerMenu(CONSTANTS.MODULE_NAME, \"resetAllSettings\", {\n    name: `${CONSTANTS.MODULE_NAME}.Settings.reset.name`,\n    hint: `${CONSTANTS.MODULE_NAME}.Settings.reset.hint`,\n    icon: \"fas fa-coins\",\n    type: ResetSettingsDialog,\n    restricted: true,\n  });\n\n  // =====================================================================\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"removeLabelButtonsSheetHeader\", {\n    name: i18n(`${CONSTANTS.MODULE_NAME}.Settings.removeLabelButtonsSheetHeader.name`),\n    hint: i18n(`${CONSTANTS.MODULE_NAME}.Settings.removeLabelButtonsSheetHeader.hint`),\n    scope: \"world\",\n    config: true,\n    type: Boolean,\n    default: true,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"keepOldIcon\", {\n    name: `${CONSTANTS.MODULE_NAME}.Settings.keepOldIcon.name`,\n    hint: `${CONSTANTS.MODULE_NAME}.Settings.keepOldIcon.hint`,\n    scope: \"world\",\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"allowNestedItems\", {\n    name: `${CONSTANTS.MODULE_NAME}.Settings.allowNestedItems.Name`,\n    hint: `${CONSTANTS.MODULE_NAME}.Settings.allowNestedItems.Hint`,\n    scope: \"world\",\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n\n  // =====================================================================\n\n  game.settings.register(CONSTANTS.MODULE_NAME, \"debug\", {\n    name: `${CONSTANTS.MODULE_NAME}.Settings.debug.name`,\n    hint: `${CONSTANTS.MODULE_NAME}.Settings.debug.hint`,\n    scope: \"client\",\n    config: true,\n    default: false,\n    type: Boolean,\n  });\n\n  // ========================================================================\n\n  for (let [name, data] of Object.entries(SETTINGS.GET_DEFAULT())) {\n    game.settings.register(CONSTANTS.MODULE_NAME, name, data);\n  }\n}\n\nexport async function applyDefaultSettings() {\n  const settings = SETTINGS.GET_SYSTEM_DEFAULTS();\n  for (const [name, data] of Object.entries(settings)) {\n    await setSetting(name, data.default);\n  }\n  await setSetting(SETTINGS.SYSTEM_VERSION, SYSTEMS.DATA.VERSION);\n}\n\nexport function applySystemSpecificStyles(data = false) {\n  // TODO ?\n}\n\nexport async function checkSystem() {\n  if (!SYSTEMS.HAS_SYSTEM_SUPPORT) {\n    if (getSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN)) return;\n\n    let settingsValid = true;\n    for (const [name, data] of Object.entries(SETTINGS.GET_DEFAULT())) {\n      settingsValid = settingsValid && getSetting(name).length !== new data.type().length;\n    }\n\n    if (settingsValid) return;\n\n    // TJSDialog.prompt({\n    //   title: game.i18n.localize(\"ITEM-PILES.Dialogs.NoSystemFound.Title\"),\n    //   content: {\n    //     class: CustomDialog,\n    //     props: {\n    //       content: game.i18n.localize(\"ITEM-PILES.Dialogs.NoSystemFound.Content\"),\n    //     },\n    //   },\n    // });\n    new Dialog({\n      title: game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.systemfound.title`),\n      content: warn(game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.systemfound.content`), true),\n      buttons: {\n        confirm: {\n          icon: '<i class=\"fas fa-check\"></i>',\n          label: game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.systemfound.confirm`),\n          callback: () => {\n            applyDefaultSettings();\n          },\n        },\n        cancel: {\n          icon: '<i class=\"fas fa-times\"></i>',\n          label: game.i18n.localize(\"No\"),\n        },\n      },\n      default: \"cancel\",\n    }).render(true);\n\n    return setSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN, true);\n  }\n\n  if (getSetting(SETTINGS.SYSTEM_FOUND) || SYSTEMS.DATA.INTEGRATION) {\n    const currentVersion = getSetting(SETTINGS.SYSTEM_VERSION);\n    const newVersion = SYSTEMS.DATA.VERSION;\n    debug(`Comparing system version - Current: ${currentVersion} - New: ${newVersion}`);\n    if (foundry.utils.isNewerVersion(newVersion, currentVersion)) {\n      debug(`Applying system settings for ${game.system.title}`);\n      await applyDefaultSettings();\n    }\n    return;\n  }\n\n  await setSetting(SETTINGS.SYSTEM_FOUND, true);\n\n  if (getSetting(SETTINGS.SYSTEM_NOT_FOUND_WARNING_SHOWN)) {\n    dialogWarning(game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.nosystemfound.content`));\n  }\n\n  return applyDefaultSettings();\n}\n\nclass ResetSettingsDialog extends FormApplication {\n  constructor(...args) {\n    //@ts-ignore\n    super(...args);\n    //@ts-ignore\n    return new Dialog({\n      title: game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.resetsettings.title`),\n      content:\n        '<p style=\"margin-bottom:1rem;\">' +\n        game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.resetsettings.content`) +\n        \"</p>\",\n      buttons: {\n        confirm: {\n          icon: '<i class=\"fas fa-check\"></i>',\n          label: game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.resetsettings.confirm`),\n          callback: async () => {\n            const worldSettings = game.settings.storage\n              ?.get(\"world\")\n              ?.filter((setting) => setting.key.startsWith(`${CONSTANTS.MODULE_NAME}.`));\n            for (let setting of worldSettings) {\n              console.log(`Reset setting '${setting.key}'`);\n              await setting.delete();\n            }\n            await applyDefaultSettings();\n            window.location.reload();\n          },\n        },\n        cancel: {\n          icon: '<i class=\"fas fa-times\"></i>',\n          label: game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Dialog.resetsettings.cancel`),\n        },\n      },\n      default: \"cancel\",\n    });\n  }\n\n  async _updateObject(event, formData) {\n    // do nothing\n  }\n}\n\n/**\n * Checks if options exist, if not, orders their initialization\n */\nexport function checkSettingsInitialized() {\n  if (!game.user?.isGM) {\n    return;\n  }\n  const defaultIcons = game.settings.get(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_ICONS);\n  const itemProperties = game.settings.get(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_PROPERTIES);\n\n  if (checkObjEmpty(defaultIcons)) {\n    initializeDefaultIcons();\n  }\n\n  if (checkObjEmpty(itemProperties)) {\n    initializeItemProperties();\n  }\n}\n\nfunction checkObjEmpty(obj) {\n  const isEmpty = Object.keys(obj).length === 0 && obj.constructor === Object;\n  if (isEmpty || obj?.object) {\n    return true;\n  }\n  return false;\n}\n\n/**\n * One-time settings initialization function\n *\n * @hook \"forien-unidentified-items:onInitializeDefaultIcons\"\n */\nfunction initializeDefaultIcons() {\n  const di = new DefaultIcons({}, {});\n  let settings = di.getSettings();\n  const icons = duplicate(settings);\n  log(JSON.stringify(icons));\n  Hooks.call(`${CONSTANTS.MODULE_NAME}:onInitializeDefaultIcons`, icons);\n  settings = mergeObject(settings, icons);\n  di.saveSettings(settings);\n  log(`Initialized default item icons.`);\n  info(game.i18n.localize(`${CONSTANTS.MODULE_NAME}.Notifications.defaultIconsInitialized`), true, true);\n}\n\n/**\n * One-time settings initialization function\n *\n * @hook \"forien-unidentified-items:onInitializeItemProperties\"\n */\nfunction initializeItemProperties() {\n  const ip = new ItemProperties({}, {});\n  let settings = ip.getSettings();\n  settings = Object.entries(settings);\n  settings = settings.map((type) => {\n    let entries = Object.entries(type[1]);\n    entries = entries.sort((a, b) => {\n      if (a[0] < b[0]) {\n        return -1;\n      }\n      if (a[0] > b[0]) {\n        return 1;\n      }\n      return 0;\n    });\n    type[1] = Object.fromEntries(entries);\n    return type;\n  });\n  settings = Object.fromEntries(settings);\n  //settings = setDefaultItemProperties(settings);\n  settings = mergeObject(settings, API.DEFAULT_PROPERTIES);\n  const properties = duplicate(settings);\n  Hooks.call(`${CONSTANTS.MODULE_NAME}:onInitializeItemProperties`, properties);\n  log(JSON.stringify(properties));\n  settings = mergeObject(settings, properties);\n  ip.saveSettings(settings);\n  log(` Initialized default item properties.`);\n  info(i18n(`${CONSTANTS.MODULE_NAME}.Notifications.defaultPropertiesInitialized`), true, true);\n}\n","import { SYSTEMS } from \"../systems.mjs\";\nimport { applySystemSpecificStyles } from \"../settings.mjs\";\nimport CONSTANTS from \"./constants.mjs\";\nimport ItemProperties from \"../apps/ItemProperties.mjs\";\nimport DefaultIcons from \"../apps/DefaultIcons.mjs\";\n\nconst SETTINGS = {\n  // Client settings\n\n  // Module Settings\n  DEFAULT_ICONS: \"defaultIcons\",\n  // Style settings\n\n  // System Settings\n  DEFAULT_PROPERTIES: \"itemProperties\",\n\n  // Hidden settings\n  SYSTEM_FOUND: \"systemFound\",\n  SYSTEM_NOT_FOUND_WARNING_SHOWN: \"systemNotFoundWarningShown\",\n  SYSTEM_VERSION: \"systemVersion\",\n\n  GET_DEFAULT() {\n    return foundry.utils.deepClone(SETTINGS.DEFAULTS());\n  },\n\n  GET_SYSTEM_DEFAULTS() {\n    return Object.fromEntries(\n      Object.entries(SETTINGS.GET_DEFAULT()).filter((entry) => {\n        return entry[1].system;\n      })\n    );\n  },\n\n  DEFAULTS: () => ({\n    [SETTINGS.DEFAULT_ICONS]: {\n      name: `${CONSTANTS.MODULE_NAME}.Settings.defaultIcons.name`,\n      hint: `${CONSTANTS.MODULE_NAME}.Settings.defaultIcons.hint`,\n      scope: \"world\",\n      config: false,\n      system: true,\n      type: DefaultIcons,\n      default: SYSTEMS.DATA.DEFAULT_ICONS,\n    },\n    [SETTINGS.DEFAULT_PROPERTIES]: {\n      name: `${CONSTANTS.MODULE_NAME}.Settings.itemProperties.name`,\n      hint: `${CONSTANTS.MODULE_NAME}.Settings.itemProperties.hint`,\n      scope: \"world\",\n      config: false,\n      system: true,\n      type: ItemProperties,\n      default: SYSTEMS.DATA.DEFAULT_PROPERTIES,\n    },\n  }),\n};\n\nexport default SETTINGS;\n","import CONSTANTS from \"../constants/constants.mjs\";\nimport SETTINGS from \"../constants/settings.mjs\";\nimport { i18n } from \"../lib/lib.mjs\";\n\nexport default class DefaultIcons extends FormApplication {\n  static get defaultOptions() {\n    const options = mergeObject(super.defaultOptions, {\n      id: \"forien-unidentified-items-default-icons\",\n      template: `/scripts/${CONSTANTS.MODULE_NAME}/templates/settings-default-icons.html`,\n      title: i18n(`${CONSTANTS.MODULE_NAME}.Settings.defaultIcons.name`),\n      submitOnClose: true,\n      submitOnChange: false,\n      closeOnSubmit: true,\n    });\n\n    if (game.system.id === \"wfrp4e\") {\n      options.classes.push(\"wfrp4e\");\n    }\n    return options;\n  }\n\n  getData(options = {}) {\n    const data = super.getData();\n    data.types = this.getItemTypes();\n    data.typeSettings = this.getSettings();\n    data.options = this.options;\n    return data;\n    // return {\n    //   types: this.getItemTypes(),\n    //   propertySettings: this.getSettings(),\n    //   options: this.options\n    // };\n  }\n\n  activateListeners(html) {\n    super.activateListeners(html);\n\n    html.on(\"change\", \"input\", (event) => {\n      const input = $(event.currentTarget);\n      const type = input.attr(\"name\");\n      $(`#default-icon-img-${type}`).attr(\"src\", String(input.val()));\n    });\n\n    html.on(\"click\", \".file-picker\", (event) => {\n      Hooks.once(\"closeFilePicker\", () => {\n        const button = $(event.currentTarget);\n        const target = button.data(\"target\");\n        $(`#forien-unidentified-items-default-icons input[name=${target}]`).trigger(\"change\");\n      });\n    });\n  }\n\n  async _updateObject(event, formData) {\n    return await this.saveSettings(formData);\n  }\n\n  getSettings() {\n    const settings = this.loadSettings();\n    const types = this.getItemTypes();\n\n    for (const type of types) {\n      const setting = getProperty(settings, type);\n      if (!setting) {\n        settings[type] = this.getIcon(this.guessIcon(type));\n      }\n    }\n\n    return settings;\n  }\n\n  guessIcon(type) {\n    const modes = [\"inv-unidentified\", \"unidentified\"];\n    const types = {\n      armor: [\"armor\", \"armour\", \"equipment\", \"gear\"],\n      book: [\"Skill\", \"book\", \"career\", \"class\", \"feat\", \"skill\", \"specialization\", \"spellbook\", \"talent\"],\n      emerald: [\"ancestry\", \"crystal\", \"jewellery\"],\n      knapsack: [\"backpack\", \"container\"],\n      loot: [\"loot\", \"treasure\"],\n      potion: [\"consumable\"],\n      sack: [\"artifact\", \"goods\", \"trapping\"],\n      scroll: [\"ability\", \"enchantment\", \"magic\", \"prayer\", \"sorcery\", \"spell\"],\n      tool: [\"tool\"],\n    };\n    const mode = modes[Math.floor(Math.random() * modes.length)];\n    let icon = mode;\n\n    for (const iconType in types) {\n      if (types[iconType].includes(type)) {\n        icon = `${mode}-${iconType}`;\n      }\n    }\n\n    return `${icon}.png`;\n  }\n\n  loadSettings() {\n    return game.settings.get(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_ICONS);\n  }\n\n  async saveSettings(data) {\n    if (data?.object) {\n      return await game.settings.set(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_ICONS, data.object);\n    } else {\n      return await game.settings.set(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_ICONS, data);\n    }\n  }\n\n  getItemTypes() {\n    return Object.keys(game.system.model.Item);\n  }\n\n  getIcon(icon) {\n    return `/scripts/${CONSTANTS.MODULE_NAME}/icons/${icon}`;\n  }\n}\n","export class MystifiedData {\n  isAbstract = false;\n  _id = undefined;\n  name = undefined;\n  type = undefined;\n  img = undefined;\n  system = undefined;\n  folder = undefined;\n  sort = undefined;\n  permission = undefined;\n  flags = undefined;\n}\n\nexport const MystifiedFlags = {\n  ORIG_DATA: \"origData\",\n};\n","import API from \"./api.mjs\";\nimport DefaultIcons from \"./apps/DefaultIcons.mjs\";\nimport CONSTANTS from \"./constants/constants.mjs\";\nimport SETTINGS from \"./constants/settings.mjs\";\nimport { MystifiedData, MystifiedFlags } from \"./ForienUnidentifiedItemsModels.mjs\";\nimport { error, i18n, i18nFormat, info, warn } from \"./lib/lib.mjs\";\n\nexport default class Identification {\n  /**\n   *\n   * @hook 'forien-unidentified-items:onMystifyItem'\n   *\n   * @param {string} itemUuid\n   * @param {Object} options\n   * @param {boolean} options.replace - set true to replace provided item with mystified one\n   * @param {MystifiedData|undefined} options.mystifiedData - item data object that should become front of mystified item\n   * @returns {Promise<void>}\n   */\n  static async mystify(\n    itemUuid,\n    options = {\n      replace: false,\n      mystifiedData: undefined,\n    }\n  ) {\n    if (!game.user?.isGM) {\n      error(`Only a GM can mistify a item`, true);\n      return;\n    }\n    if (!itemUuid) {\n      warn(`Cannot mystify a no item`, true);\n      return;\n    }\n    const item = await this._itemFromUuid(itemUuid);\n    if (!item) {\n      warn(`Cannot mystify a no item from uuid '${itemUuid}'`, true);\n      return;\n    }\n\n    const origData = duplicate(item);\n    let mystifiedData = options.mystifiedData;\n\n    if (mystifiedData === undefined) {\n      mystifiedData = this._getMystifiedData(origData);\n    }\n\n    Hooks.call(`${CONSTANTS.MODULE_NAME}:onMystifyItem`, item, origData, mystifiedData, options);\n\n    let mystifiedItem;\n    if (options.replace) {\n      const template = { data: game.system.model.Item[item.type] };\n      mystifiedData = mergeObject(template, mystifiedData);\n      if (!mystifiedData.flags) {\n        mystifiedData.flags = {};\n      }\n      await item.update(mystifiedData);\n      mystifiedItem = item;\n    } else {\n      if (!mystifiedData.flags) {\n        mystifiedData.flags = {};\n      }\n      mystifiedItem = await Item.create(mystifiedData);\n    }\n\n    await mystifiedItem.setFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA, origData);\n    return mystifiedItem;\n  }\n\n  /**\n   *\n   * @param {string} itemUuid\n   * @returns {Promise<void>}\n   */\n  static async mystifyReplace(itemUuid) {\n    return await this.mystify(itemUuid, { replace: true, mystifiedData: undefined });\n  }\n\n  /**\n   *\n   * @param {string} itemUuid\n   * @returns {Promise<void>}\n   */\n  static async mystifyAsDialog(itemUuid) {\n    if (!itemUuid) {\n      warn(`Cannot mystify advanced a no item`, true);\n      return;\n    }\n    const origItem = await this._itemFromUuid(itemUuid);\n    if (!origItem) {\n      warn(`Cannot  mystify advanced a no item from uuid '${itemUuid}'`, true);\n      return;\n    }\n\n    const nameItem = origItem.name;\n    let itemTmp;\n    let replace;\n\n    const dialog = new Dialog(\n      {\n        title: i18nFormat(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.Title`, { nameItem }),\n        content: `<h3>${i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.Header`)}</h3>\n\t\t\t\t\t<div class=\"dropzone\">\n\t\t\t\t\t\t<p>${i18nFormat(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.DropZone`, { nameItem })}</p>\n\t\t\t\t\t\t<div class=\"item\" style=\"display: none\">\n\t\t\t\t\t\t\t<img/>\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`,\n        buttons: {\n          mystifyAdvanced: {\n            icon: '<i class=\"fas fa-cogs\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.MystifyAdvanced`),\n            callback: (html) => {\n              const source = $(html).find(\".item\").data(\"item\");\n              this.mystifyAdvancedDialog(itemUuid, source);\n            },\n          },\n          cancel: {\n            icon: '<i class=\"fas fa-times\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.Cancel`),\n          },\n          mystifyReplace: {\n            icon: '<i class=\"fas fa-sync-alt\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.MystifyReplace`),\n            callback: (html) => {\n              itemTmp = $(html).find(\".item\").data(\"item\");\n              replace = true;\n            },\n          },\n          mystify: {\n            icon: '<i class=\"fas fa-eye-slash\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAs.Mystify`),\n            callback: (html) => {\n              itemTmp = $(html).find(\".item\").data(\"item\");\n            },\n          },\n        },\n        default: \"cancel\",\n        close: () => {\n          if (itemTmp) {\n            delete itemTmp._id;\n            //let options = {mystifiedData: item};\n            //if (replace) options.replace = true;\n            //this.mystify(itemUuid, options);\n            if (replace) {\n              this.mystify(itemUuid, { replace: true, mystifiedData: itemTmp });\n            } else {\n              this.mystify(itemUuid, { replace: false, mystifiedData: itemTmp });\n            }\n          }\n        },\n        render: (html) => {\n          $(html)\n            .on(\"dragover\", false)\n            .on(\"drop\", \".dropzone\", async (event) => {\n              event.preventDefault();\n              event.stopPropagation();\n              let item;\n              const data = JSON.parse(event.originalEvent?.dataTransfer?.getData(\"text/plain\"));\n              if (data.type === \"Item\") {\n                if (data.uuid) {\n                  const witem = await this._uuidToDocument(data.uuid);\n                  item = duplicate(witem);\n                  // } else if (data.pack) {\n                  // \tconst witem = await this._getItemFromPack(data.pack, data.id);\n                  // \titem = duplicate(witem);\n                } else if (data) {\n                  item = data;\n                } else {\n                  const witem = game.items?.get(data.id);\n                  if (!witem) {\n                    return;\n                  }\n                  item = duplicate(witem);\n                }\n                if (item) {\n                  $(event.currentTarget).find(\".item\").data(\"item\", item);\n                  $(event.currentTarget)\n                    .find(\".item\")\n                    .slideUp(200, () => {\n                      $(event.currentTarget).find(\".item img\").attr(\"src\", item.img);\n                      $(event.currentTarget).find(\".item span\").text(item.name);\n                      $(event.currentTarget).find(\".item\").slideDown();\n                    });\n                }\n              }\n            });\n        },\n      },\n      {\n        id: \"forien-unidentified-items-mystifyAsDialog\",\n        width: 440,\n        height: \"auto\",\n      }\n    );\n\n    await dialog.render(true);\n  }\n\n  /**\n   *\n   * @param {string} itemUuid\n   * @param {Item|undefined} source\n   * @returns {Promise<void>}\n   */\n  static async mystifyAdvancedDialog(itemUuid, source = undefined) {\n    if (!itemUuid) {\n      warn(`Cannot mystify advanced a no item`, true);\n      return;\n    }\n    const origItem = await this._itemFromUuid(itemUuid);\n    if (!origItem) {\n      warn(`Cannot  mystify advanced a no item from uuid '${itemUuid}'`, true);\n      return;\n    }\n\n    const nameItem = origItem.name;\n    const sourceData = source ? source : duplicate(origItem);\n    const meta = this._getMystifiedMeta(sourceData);\n    const keepOldIcon = this.keepOriginalImage();\n\n    const selectedImg = keepOldIcon ? sourceData.img : meta.img;\n\n    let properties = this._getTypeProperties(sourceData);\n    properties = Object.fromEntries(\n      Object.keys(properties).map((property) => {\n        return [\n          property,\n          {\n            key: property,\n            orig: getProperty(sourceData, `data.${property}`),\n            default: getProperty(game.system?.model.Item[sourceData.type], property),\n            value: properties[property],\n          },\n        ];\n      })\n    );\n\n    const htmlTmp = await renderTemplate(`/scripts/${CONSTANTS.MODULE_NAME}/templates/mystify-advanced.html`, {\n      item: sourceData,\n      meta: meta,\n      properties: properties,\n      keepOldIcon: keepOldIcon,\n      selectedImg: selectedImg,\n    });\n\n    let confirmed = false;\n    let replace;\n    const dialog = new Dialog(\n      {\n        title: i18nFormat(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAdvanced.Title`, { nameItem }),\n        content: htmlTmp,\n        buttons: {\n          cancel: {\n            icon: '<i class=\"fas fa-times\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAdvanced.Cancel`),\n          },\n          mystifyReplace: {\n            icon: '<i class=\"fas fa-sync-alt\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAdvanced.MystifyReplace`),\n            callback: (html) => {\n              confirmed = true;\n              replace = true;\n            },\n          },\n          mystify: {\n            icon: '<i class=\"fas fa-eye-slash\"></i>',\n            label: i18n(`${CONSTANTS.MODULE_NAME}.Dialog.MystifyAdvanced.Mystify`),\n            callback: (html) => {\n              confirmed = true;\n            },\n          },\n        },\n        default: \"cancel\",\n        close: (html) => {\n          if (!confirmed) {\n            return;\n          }\n          const form = html.find(\"form\")[0];\n          const formDataBase = new FormDataExtended(form, {});\n\n          formDataBase.delete(\"img-keep\");\n          formDataBase.delete(\"name-keep\");\n\n          const formData = Object.fromEntries(Object.entries(formDataBase.toObject()).filter((e) => e[1] !== false));\n\n          for (const property of Object.keys(formData)) {\n            // if (property.startsWith(\"data.\")) {\n            // \tdelete formData[property];\n            // \tsetProperty(formData, property, getProperty(sourceData, property));\n            // }\n            if (property) {\n              if (property.startsWith(\"system.\")) {\n                if (formData[property]) {\n                  delete formData[property];\n                }\n                setProperty(formData, property, getProperty(sourceData, property));\n              } else {\n                warn(`Cannot set the property '${property}' maybe is a issue ?`);\n              }\n            }\n          }\n\n          //let options = {mystifiedData: formData};\n          //if (replace) options.replace = true;\n          //this.mystify(itemUuid, options);\n          if (replace) {\n            this.mystify(itemUuid, { replace: true, mystifiedData: formData });\n            this.mystify(itemUuid, { replace: true, mystifiedData: formData });\n          } else {\n            this.mystify(itemUuid, { replace: false, mystifiedData: formData });\n          }\n        },\n      },\n      {\n        id: \"forien-unidentified-items-mystifyAdvancedDialog\",\n      }\n    );\n    await dialog.render(true);\n\n    const jqDialog = $(\"#forien-unidentified-items-mystifyAdvancedDialog\");\n\n    jqDialog.on(\"change\", \"input[name=img-keep]\", async (event) => {\n      const checked = $(event.currentTarget).prop(\"checked\");\n\n      const src = checked ? sourceData.img : meta.img;\n      jqDialog.find(\".img-preview\").attr(\"src\", src);\n      jqDialog.find(\"input[name=img]\").val(src);\n    });\n\n    jqDialog.on(\"change\", \"input[name=name-keep]\", async (event) => {\n      const checked = $(event.currentTarget).prop(\"checked\");\n\n      const nameChanged = checked ? sourceData.name : meta.name;\n      jqDialog.find(\".name-preview\").text(nameChanged ?? \"\");\n      jqDialog.find(\"input[name=name]\").val(nameChanged ?? \"\");\n    });\n  }\n\n  /**\n   *\n   * @hook 'forien-unidentified-items:onIdentifyItem'\n   *\n   * @param {Item} item\n   * @returns {Promise<Item|undefined>}\n   */\n  static async identify(item) {\n    if (!item) {\n      warn(`Cannot identify a no item`, true);\n      return;\n    }\n    const origData = item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n    if (!origData) {\n      warn(`Cannot identify a no mistify item`, true);\n      return;\n    }\n    // things to keep from mystified item:\n    // delete origData._id;\n    if (origData.permission) {\n      try {\n        delete origData.permission;\n      } catch (e) {\n        // do nothing\n      }\n    }\n    //@ts-ignore\n    if (origData.ownership) {\n      try {\n        //@ts-ignore\n        delete origData.ownership;\n      } catch (e) {\n        // do nothing\n      }\n    }\n    if (origData.folder) {\n      try {\n        //@ts-ignore\n        delete origData.folder;\n      } catch (e) {\n        // do nothing\n      }\n    }\n    const hook = Hooks.call(`${CONSTANTS.MODULE_NAME}:onIdentifyItem`, item, origData);\n    if (hook !== false) {\n      await item.update(origData, { diff: false });\n      await item.unsetFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n      // If there was nested origData, carry it over.\n      const origDataOrigData = getProperty(origData.flags, `${CONSTANTS.MODULE_NAME}.origData`);\n      await item.setFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA, origDataOrigData);\n    }\n    return item;\n  }\n\n  /**\n   *\n   * @param {Item} item\n   * @return {boolean}\n   */\n  static isMystified(item) {\n    if (!item) {\n      return false;\n    }\n    const origData = item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n    return origData !== undefined;\n  }\n\n  /**\n   *\n   * @param {Item} item\n   * @return {Object}\n   */\n  static getOrigData(item) {\n    return item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n  }\n\n  /**\n   *\n   * @param {string} uuid\n   * @return {boolean}\n   */\n  static async isUuidMystified(uuid) {\n    if (!uuid) {\n      return false;\n    }\n    const item = await this._itemFromUuid(uuid);\n    if (!item) {\n      warn(`No item found for uuid '${uuid}'`, true);\n      return false;\n    }\n    const origData = item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n    return origData !== undefined;\n  }\n\n  /**\n   *\n   * @param {MystifiedData} origData\n   * @returns {{img: String, name: String, type: String, data: Object}}\n   * @private\n   */\n  static _getMystifiedData(origData) {\n    const mystifiedData = this._getMystifiedMeta(origData);\n    const itemProperties = this._getDefaultProperties(origData);\n\n    for (const property of itemProperties) {\n      // const propertyTmp = \"data.\" + property;\n      // const valueTmp = getProperty(origData, propertyTmp);\n      // setProperty(mystifiedData, propertyTmp, valueTmp);\n      if (property) {\n        let propertyTmp = undefined;\n        if (property.startsWith(\"system.\")) {\n          propertyTmp = property;\n        } else {\n          propertyTmp = \"system.\" + property;\n        }\n        const valueTmp = getProperty(origData, propertyTmp);\n        setProperty(mystifiedData, propertyTmp, valueTmp);\n      } else {\n        warn(`Cannot set the property '${property}' maybe is a issue ?`);\n      }\n    }\n\n    if (this.keepOriginalImage()) {\n      mystifiedData.img = origData.img;\n    }\n\n    return mystifiedData;\n  }\n\n  /**\n   *\n   * @param {Object} origData\n   * @returns {Array}\n   * @private\n   */\n  static _getDefaultProperties(origData) {\n    let itemProperties = this._getTypeProperties(origData);\n    itemProperties = Object.entries(itemProperties)\n      .filter((p) => p[1])\n      .map((p) => p[0]);\n\n    return itemProperties;\n  }\n\n  /**\n   *\n   * @param {Object} origData\n   * @return {Object}\n   * @private\n   */\n  static _getTypeProperties(origData) {\n    const defaultProperties = API.DEFAULT_PROPERTIES;\n    return defaultProperties[origData.type];\n  }\n\n  static keepOriginalImage() {\n    return game.settings.get(CONSTANTS.MODULE_NAME, \"keepOldIcon\");\n  }\n\n  /**\n   *\n   * @param {Object} origData\n   * @returns {{img: String, name: String, type: String}}\n   * @private\n   */\n  static _getMystifiedMeta(origData) {\n    const iconSettings = API.DEFAULT_ICONS;\n    const iconType =\n      getProperty(iconSettings, origData.type) || `/scripts/${CONSTANTS.MODULE_NAME}/icons/${CONSTANTS.DEFAULT_ICON}`;\n\n    return {\n      name: i18n(`${CONSTANTS.MODULE_NAME}.NewMystified`),\n      type: origData.type,\n      img: iconType,\n    };\n  }\n\n  /**\n   *\n   * @param {string} uuid\n   * @returns {Promise<Item|undefined>}\n   * @private\n   */\n  static async _itemFromUuid(uuid) {\n    return this._uuidToDocument(uuid);\n    // const parts = <string[]>uuid.split(\".\");\n    // const [entityName, entityId, embeddedName, embeddedId] = parts;\n\n    // if (embeddedName === \"OwnedItem\" || embeddedName === \"Item\") {\n    // \tif (parts.length === 4) {\n    // \t\tconst actor = <Actor>game.actors?.get(entityId);\n    // \t\tif (!actor) {\n    // \t\t\treturn undefined;\n    // \t\t}\n    // \t\treturn actor.items.get(embeddedId);\n    // \t}\n    // } else {\n    // \treturn await fromUuid(uuid);\n    // }\n    // return;\n  }\n\n  // /**\n  //  *\n  //  * @param {string} packId\n  //  * @param {string} itemId\n  //  * @return {Promise.<Item|undefined>}\n  //  * @deprecated do not use this anymore\n  //  * @private\n  //  */\n  // static async _getItemFromPack(packId:string, itemId:string) {\n  // \tconst pack = <CompendiumCollection<CompendiumCollection.Metadata>>game.packs.get(packId);\n  // \tif (pack.documentName !== \"Item\") {\n  // \t\treturn null;\n  // \t}\n  // \treturn await pack.getDocument(itemId).then((ent) => {\n  // \t\t//delete ent?._id;\n  // \t\t//@ts-ignore\n  // \t\tif (ent?._id) {\n  // \t\t\t//@ts-ignore\n  // \t\t\tent._id = \"\";\n  // \t\t}\n  // \t\treturn ent;\n  // \t});\n  // }\n\n  static async _uuidToDocument(uuid) {\n    const parts = uuid.split(\".\");\n    let result = null;\n    if (parts[0] === \"Compendium\") {\n      const pack = game[\"packs\"].get(parts[1] + \".\" + parts[2]);\n      if (pack !== undefined) {\n        result = await pack.getDocument(parts[3]);\n      }\n    } else {\n      result = await fromUuid(uuid);\n    }\n    if (result === null) {\n      error(`Document Not Found for uuid ${uuid}`);\n      result = null;\n    }\n    return result;\n  }\n}\n","import DefaultIcons from \"./apps/DefaultIcons.mjs\";\nimport CONSTANTS from \"./constants/constants.mjs\";\nimport { MystifiedData } from \"./ForienUnidentifiedItemsModels.mjs\";\nimport Identification from \"./ForienUnidentifiedItemsIdentification.mjs\";\nimport SETTINGS from \"./constants/settings.mjs\";\n\nconst API = {\n  get DEFAULT_PROPERTIES() {\n    const settingDefaultProperties = game.settings.get(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_PROPERTIES);\n    if (settingDefaultProperties?.object) {\n      return settingDefaultProperties.object;\n    }\n    return settingDefaultProperties;\n  },\n\n  /**\n   * The attributes used to track dynamic attributes in this system\n   *\n   * @returns {array}\n   */\n  get DEFAULT_ICONS() {\n    const settingDefaultIcons = game.settings.get(CONSTANTS.MODULE_NAME, SETTINGS.DEFAULT_ICONS);\n    if (settingDefaultIcons?.object) {\n      return settingDefaultIcons.object;\n    }\n    return settingDefaultIcons;\n  },\n\n  /**\n   *\n   * @hook 'forien-unidentified-items:onMystifyItem'\n   *\n   * @param {string} itemUuid\n   * @param {Object} options\n   * @param {boolean} options.replace - set true to replace provided item with mystified one\n   * @param {MystifiedData|undefined} options.mystifiedData - item data object that should become front of mystified item\n   * @returns {Promise<Item|undefined>}\n   */\n  async mystify(\n    itemUuid,\n    options = {\n      replace: false,\n      mystifiedData: undefined,\n    }\n  ) {\n    return await Identification.mystify(itemUuid, options);\n  },\n\n  /**\n   *\n   * @param {string} itemUuid\n   * @returns {Promise<Item|undefined>}\n   */\n  async mystifyReplace(itemUuid) {\n    return await Identification.mystifyReplace(itemUuid);\n  },\n\n  /**\n   *\n   * @param {string} itemUuid\n   * @returns {Promise<void>}\n   */\n  async mystifyAsDialog(itemUuid) {\n    await Identification.mystifyAsDialog(itemUuid);\n  },\n\n  /**\n   *\n   * @param {string} itemUuid\n   * @param {object} source\n   * @returns {Promise<void>}\n   */\n  async mystifyAdvancedDialog(itemUuid, source = undefined) {\n    await Identification.mystifyAdvancedDialog(itemUuid, source);\n  },\n\n  /**\n   *\n   * @hook 'forien-unidentified-items:onIdentifyItem'\n   *\n   * @param {Item} item\n   * @returns {Promise<Item|undefined>}\n   */\n  async identify(item) {\n    return await Identification.identify(item);\n  },\n\n  /**\n   *\n   * @param {Item} item\n   * @return {boolean}\n   */\n  isMystified(item) {\n    return Identification.isMystified(item);\n  },\n\n  /**\n   *\n   * @param {Item} item\n   * @return {MystifiedData}\n   */\n  getOrigData(item) {\n    return Identification.getOrigData(item);\n  },\n\n  /**\n   *\n   * @param {string} uuid\n   * @return {boolean}\n   */\n  async isUuidMystified(uuid) {\n    return await Identification.isUuidMystified(uuid);\n  },\n};\n\nexport default API;\n","import API from \"./api.mjs\";\nimport CONSTANTS from \"./constants/constants.mjs\";\nimport { MystifiedData, MystifiedFlags } from \"./ForienUnidentifiedItemsModels.mjs\";\nimport { i18n } from \"./lib/lib.mjs\";\n\nexport default function registerDerivedItemSheetClass() {\n  //@ts-ignore\n  for (const k in CONFIG.Item.sheetClasses) {\n    //@ts-ignore\n    for (const l in CONFIG.Item.sheetClasses[k]) {\n      //@ts-ignore\n      const cls = CONFIG.Item.sheetClasses[k][l].cls;\n      //@ts-ignore\n      CONFIG.Item.sheetClasses[k][l].cls = getItemSheetClass(cls, l);\n    }\n  }\n}\n\nfunction getItemSheetClass(cls, sheet) {\n  const ParentClass = cls;\n\n  const ItemClass = class extends ParentClass {\n    constructor(...args) {\n      super(...args);\n      this.name = sheet.split(\".\")[1];\n    }\n\n    /**\n     * Adds `[Mystified]` to the windows title if item is Mystified\n     * Adds `[Original]` to the windows title if item is Original\n     * @return {string}\n     */\n    get title() {\n      let title = super.title;\n      if (!game.user?.isGM) {\n        return title;\n      }\n      if (this.item.isMystified()) {\n        title = \"[\" + i18n(`${CONSTANTS.MODULE_NAME}.Item.Mystified`) + \"] \" + `${title}`;\n      }\n      if (this.item.isAbstract) {\n        title = \"[\" + i18n(`${CONSTANTS.MODULE_NAME}.Item.Original`) + \"] \" + `${title}`;\n      }\n      return title;\n    }\n\n    /**\n     * @override\n     *\n     * @hook \"forien-unidentified-items:getItemPermissions\"\n     */\n    _getHeaderButtons() {\n      const buttons = super._getHeaderButtons();\n      const isAbstract = this.item.isAbstract || false;\n      const removeLabelButtonsSheetHeader = game.settings.get(CONSTANTS.MODULE_NAME, \"removeLabelButtonsSheetHeader\");\n\n      let permissions = {\n        canIdentify: game.user?.isGM,\n        canPeek: game.user?.isGM,\n        canMystify: game.user?.isGM,\n      };\n      const hookPermissions = duplicate(permissions);\n      Hooks.call(`${CONSTANTS.MODULE_NAME}:getItemPermissions`, this.item, hookPermissions);\n      permissions = mergeObject(permissions, hookPermissions);\n\n      const origData = this.item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n\n      if (origData) {\n        if (permissions.canIdentify && !isAbstract) {\n          buttons.unshift({\n            label: removeLabelButtonsSheetHeader ? \"\" : `${CONSTANTS.MODULE_NAME}.Identify`,\n            class: \"forien-unidentified-items-identify-item\",\n            icon: \"fas fa-search\",\n            onclick: (ev) => {\n              API.identify(this.item);\n            },\n          });\n        }\n\n        if (permissions.canPeek) {\n          buttons.unshift({\n            label: removeLabelButtonsSheetHeader ? \"\" : `${CONSTANTS.MODULE_NAME}.Peek`,\n            class: \"forien-unidentified-items-peek-original-item\",\n            icon: \"far fa-eye\",\n            onclick: (ev) => {\n              //@ts-ignore\n              const entity = new CONFIG.Item.documentClass(origData, { editable: false });\n              //@ts-ignore\n              entity.isAbstract = true;\n              const sheetTmp = entity.sheet;\n              sheetTmp?.render(true);\n            },\n          });\n        }\n      } else {\n        if (permissions.canMystify && !isAbstract) {\n          if (this.item.isOwned) {\n            buttons.unshift({\n              label: removeLabelButtonsSheetHeader ? \"\" : `${CONSTANTS.MODULE_NAME}.Mystify`,\n              class: \"forien-unidentified-items-mystify-item\",\n              icon: \"far fa-eye-slash\",\n              onclick: (ev) => {\n                API.mystifyReplace(this.item.uuid);\n              },\n            });\n          } else {\n            buttons.unshift({\n              label: removeLabelButtonsSheetHeader ? \"\" : `${CONSTANTS.MODULE_NAME}.Mystify`,\n              class: \"forien-unidentified-items-mystify-item\",\n              icon: \"far fa-eye-slash\",\n              onclick: (ev) => {\n                API.mystify(this.item.uuid);\n              },\n            });\n          }\n        }\n      }\n\n      return buttons;\n    }\n\n    async _updateObject(...args) {\n      if (this.item.isAbstract) {\n        return this;\n      }\n      return super._updateObject(...args);\n    }\n  };\n\n  return ItemClass;\n}\n","import API from \"./api.mjs\";\nimport CONSTANTS from \"./constants/constants.mjs\";\nimport { MystifiedData, MystifiedFlags } from \"./ForienUnidentifiedItemsModels.mjs\";\n\nexport default function registerContextMenuHook() {\n  Hooks.on(\"getItemDirectoryEntryContext\", (html, entryOptions) => {\n    const getOrigData = (li) => {\n      const id = li[0].dataset.documentId;\n      const item = game.items?.get(id);\n\n      return item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n    };\n\n    const mystifyCondition = (li) => {\n      if (!game.user?.isGM) return false;\n      const origData = getOrigData(li);\n      const allowNested = game.settings.get(CONSTANTS.MODULE_NAME, \"allowNestedItems\");\n\n      return !origData || allowNested;\n    };\n\n    const identifyCondition = (li) => {\n      if (!game.user?.isGM) return false;\n      const origData = getOrigData(li);\n\n      return !!origData;\n    };\n\n    const mystifyOptions = [\n      {\n        name: `${CONSTANTS.MODULE_NAME}.Mystify`,\n        icon: '<i class=\"far fa-eye-slash\"></i>',\n        condition: mystifyCondition,\n        callback: (li) => {\n          const id = li[0].dataset.documentId;\n          API.mystify(`Item.${id}`);\n        },\n      },\n      {\n        name: `${CONSTANTS.MODULE_NAME}.MystifyReplace`,\n        icon: '<i class=\"far fa-eye-slash\"></i>',\n        condition: mystifyCondition,\n        callback: (li) => {\n          const id = li[0].dataset.documentId;\n          API.mystifyReplace(`Item.${id}`);\n        },\n      },\n      {\n        name: `${CONSTANTS.MODULE_NAME}.MystifyAs`,\n        icon: '<i class=\"far fa-eye-slash\"></i>',\n        condition: mystifyCondition,\n        callback: (li) => {\n          const id = li[0].dataset.documentId;\n          API.mystifyAsDialog(`Item.${id}`);\n        },\n      },\n      {\n        name: `${CONSTANTS.MODULE_NAME}.MystifyAdvanced`,\n        icon: '<i class=\"far fa-eye-slash\"></i>',\n        condition: mystifyCondition,\n        callback: (li) => {\n          const id = li[0].dataset.documentId;\n          API.mystifyAdvancedDialog(`Item.${id}`);\n        },\n      },\n    ];\n\n    entryOptions.unshift(...mystifyOptions);\n\n    entryOptions.unshift({\n      name: `${CONSTANTS.MODULE_NAME}.Identify`,\n      icon: '<i class=\"fas fa-search\"></i>',\n      condition: identifyCondition,\n      callback: (li) => {\n        const id = li[0].dataset.documentId;\n        const item = game.items?.get(id);\n        API.identify(item);\n      },\n    });\n\n    entryOptions.unshift({\n      name: `${CONSTANTS.MODULE_NAME}.Peek`,\n      icon: '<i class=\"far fa-eye\"></i>',\n      condition: identifyCondition,\n      callback: (li) => {\n        const id = li[0].dataset.documentId;\n        const item = game.items?.get(id);\n        const origData = item.getFlag(CONSTANTS.MODULE_NAME, MystifiedFlags.ORIG_DATA);\n        origData.isAbstract = true;\n        //@ts-ignore\n        const entity = new CONFIG.Item.documentClass(origData, { editable: false });\n        const sheet = entity.sheet;\n        sheet?.render(true);\n      },\n    });\n  });\n}\n","import API from \"./api.mjs\";\nimport { MystifiedFlags } from \"./ForienUnidentifiedItemsModels.mjs\";\n\nexport default function registerItemClassMethod() {\n  //@ts-ignore\n  CONFIG.Item.documentClass.prototype.isMystified = function isMystified() {\n    return API.isMystified(this);\n  };\n\n  Object.defineProperty(CONFIG.Item.documentClass.prototype, MystifiedFlags.ORIG_DATA, {\n    get: function origData() {\n      return API.getOrigData(this);\n    },\n  });\n}\n","/**\n * This is your TypeScript entry file for Foundry VTT.\n * Register custom settings, sheets, and constants using the Foundry API.\n * Change this heading to be more descriptive to your module, or remove it.\n * Author: [your name]\n * Content License: [copyright and-or license] If using an existing system\n * \t\t\t\t\tyou may want to put a (link to a) license or copyright\n * \t\t\t\t\tnotice here (e.g. the OGL).\n * Software License: [your license] Put your desired license here, which\n * \t\t\t\t\t determines how others may use and modify your module\n */\n// Import JavaScript modules\n\n// Import TypeScript modules\nimport registerDerivedItemSheetClass from \"./scripts/ForienUnidentifiedItemsItemSheet.mjs\";\nimport registerContextMenuHook from \"./scripts/ContextMenu.mjs\";\nimport registerSettings, { checkSettingsInitialized } from \"./scripts/settings.mjs\";\nimport registerItemClassMethod from \"./scripts/ForienUnidentifiedItemsItem.mjs\";\nimport CONSTANTS from \"./scripts/constants/constants.mjs\";\nimport API from \"./scripts/api.mjs\";\n\n/* ------------------------------------ */\n/* Initialize module\t\t\t\t\t*/\n/* ------------------------------------ */\n\nHooks.once(\"init\", () => {\n  registerSettings();\n\n  registerContextMenuHook();\n\n  Hooks.callAll(`${CONSTANTS.MODULE_NAME}:afterInit`);\n});\n\n/* ------------------------------------ */\n/* Setup module\t\t\t\t\t\t\t*/\n/* ------------------------------------ */\n\nHooks.once(\"setup\", () => {\n  //@ts-ignore\n  // window.ForienIdentification = Identification;\n\n  Hooks.callAll(`${CONSTANTS.MODULE_NAME}:afterSetup`);\n\n  setApi(API);\n});\n\n/* ------------------------------------ */\n/* When ready\t\t\t\t\t\t\t*/\n/* ------------------------------------ */\n\nHooks.once(\"ready\", () => {\n  checkSettingsInitialized();\n  registerDerivedItemSheetClass();\n  registerItemClassMethod();\n\n  Hooks.callAll(`${CONSTANTS.MODULE_NAME}:afterReady`);\n});\n\n// Add any additional hooks if necessary\n\n/**\n * Initialization helper, to set API.\n * @param api to set to game module.\n */\nexport function setApi(api) {\n  const data = game.modules.get(CONSTANTS.MODULE_NAME);\n  data.api = api;\n}\n\n/**\n * Returns the set API.\n * @returns Api from games module.\n */\nexport function getApi() {\n  const data = game.modules.get(CONSTANTS.MODULE_NAME);\n  return data.api;\n}\n\n/**\n * Initialization helper, to set Socket.\n * @param socket to set to game module.\n */\nexport function setSocket(socket) {\n  const data = game.modules.get(CONSTANTS.MODULE_NAME);\n  data.socket = socket;\n}\n\n/*\n * Returns the set socket.\n * @returns Socket from games module.\n */\nexport function getSocket() {\n  const data = game.modules.get(CONSTANTS.MODULE_NAME);\n  return data.socket;\n}\n"],"names":["version","info","error","SETTINGS","API"],"mappings":"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"}